(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function c(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=c(s);fetch(s.href,r)}})();const m=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(c){console.error(`Error saving ${{key:e,value:t}} to localStorage`,c)}},S=e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error(`Error saving ${{key:e,value}} to localStorage`,t),null}},T=e=>{e==null||e.classList.toggle("App--isDark"),e.classList.contains("App--isDark")?m("theme","dark"):m("theme","light")},E=e=>{S("theme")==="dark"?e.classList.add("App--isDark"):e.classList.remove("App--isDark")};function A(e){if(typeof e!="string")return e==null?"":String(e);const t={"&":"&","<":"<",">":">",'"':'"',"'":"'"};return e.replace(/[&<>"']/g,c=>t[c])}const b=document.querySelector(".App"),v=document.querySelector(".DarkThemeToggle"),k="taskList";let a=S(k)||[];const u=document.querySelector(".TaskSearchBar__searchContent"),n=document.querySelector(".TaskList__list"),i=document.querySelector("#validationPopup"),_=document.querySelector("#popupMessage"),g=document.querySelector("#closePopupBtn"),l=document.querySelector("#deleteConfirmPopup"),h=document.querySelector("#confirmDeleteBtn"),y=document.querySelector("#cancelDeleteBtn"),d=document.querySelector(".TaskList__link"),L=()=>{if(n)n.innerHTML="";else{console.error("Task container not found in renderTasks.");return}let e="";a.length===0?n.innerHTML=`
    <li class="EmptyList" >
      <img 
        src="/images/icon-empty.svg" 
        alt="قائمة المهام فارغة" 
        class="EmptyList__img"
      />
        
        <label class="EmptyList__text" for="search-input" style="cursor:pointer;display:inline-block">أضف مهمتك الأولى بالضغط علي <strong>إضافة</strong> بالأعلي</label>
    </li>`:(a.forEach(t=>{e+=`
        <li class="TaskList__taskContent ${t.isCompleted?" TaskList__taskContent--isActive":""}" data-task-id="${t.id}">
          <div class="TaskList__checkbox" tabindex="0" role="button" aria-label="Mark task as ${t.isCompleted?"incomplete":"complete"}">
            <img src="/images/icon-checkmark.svg" alt="checkmark icon" class="TaskList__checkboxImage"/>
          </div>
          <div class="TaskList__valueContent">
            <p class="TaskList__value">${t.value}</p>
          </div>
          <img src="/images/icon-basket.svg" alt="delete task" class="TaskList__deleteIcon" aria-label="Delete task" tabindex="0" role="button"/>
        </li>`}),n.innerHTML=e)},I=e=>{e.preventDefault();const t=u.elements[0],c=t.value.trim();if(!c){_&&(_.textContent="يُرجى إدخال نص المهمة. لا يمكن ترك هذا الحقل فارغًا."),i&&i.classList.add("Popup--isActive"),t.focus();return}i&&i.classList.contains("Popup--isActive")&&i.classList.remove("Popup--isActive");const o=A(c),s={id:crypto.randomUUID().replaceAll("-",""),value:o,isCompleted:!1};a.push(s),m(k,a),L(),u.reset()},q=e=>{const t=a.findIndex(c=>c.id===e);t>-1?(a.splice(t,1),m(k,a),L()):console.warn("Task with ID not found, could not delete:",e)};let p=null;const x=e=>{const t=e.target.closest(".TaskList__taskContent");if(!t)return;const c=t.dataset.taskId,o=a.find(s=>s.id===c);o&&(o.isCompleted=!o.isCompleted,m(k,a),L())};v==null||v.addEventListener("click",()=>{T(b)});u==null||u.addEventListener("submit",I);g==null||g.addEventListener("click",()=>{i==null||i.classList.remove("Popup--isActive")});i==null||i.addEventListener("click",e=>{e.target===i&&i.classList.remove("Popup--isActive")});n==null||n.addEventListener("click",e=>{if(e.target.closest(".TaskList__deleteIcon")){const o=e.target.closest(".TaskList__taskContent");o&&(p=o.dataset.taskId,l==null||l.classList.add("Popup--isActive"));return}e.target.closest(".TaskList__checkbox")&&x(e)});h==null||h.addEventListener("click",()=>{p&&(q(p),l==null||l.classList.remove("Popup--isActive"),p=null)});y==null||y.addEventListener("click",()=>{l==null||l.classList.remove("Popup--isActive"),p=null});d==null||d.addEventListener("click",()=>{d.classList.contains("is-hiding-completed")?(d.classList.remove("is-hiding-completed"),n.classList.remove("hide-completed")):n.querySelectorAll(".TaskList__taskContent--isActive").length>0&&(d.classList.add("is-hiding-completed"),n.classList.add("hide-completed"))});document.addEventListener("DOMContentLoaded",()=>{E(b),L()});
